{% extends 'layout.html' %}

{% block page_title %}<h1><i class="fas fa-cog"></i> Settings</h1>{% endblock %}

{% block meta_title %}Settings{% endblock %}

{% block jsfiles %}
    {% assets 'js_friends' %}<script src="{{ ASSET_URL }}"></script>{% endassets %}
{% endblock %}

{% block content %}
    <div class="grid has-gutter mts">
        <div>
            <h2 id="general">General settings</h2>

            <form method="post" action="{{ url_for('user_settings') }}">
                {{ form.csrf_token }}

                {{ macros.form_field(form.is_profile_public) }}

                <p class="txtcenter mtm"><button type="submit">Save</button></p>
            </form>
        </div>
        <div>
            <h2 id="pat">Personal Access Token</h2>

            <p>This is the token that must be used to access the <a href="{{ url_for('static', filename='/api_doc.html') }}">RWRS REST API</a>. <strong>This token is personal.</strong> Be careful when sharing with third-party applications.</p>

            <div class="txtcenter mts"><input type="text" readonly spellcheck="false" value="{{ current_user.pat if current_user.pat else 'Click the button to generate one ðŸ‘‰' }}" class="w300p copypaste txtcenter" onClick="this.setSelectionRange(0, this.value.length)"> <button title="Generate a new Personal Access Token" onclick="return confirm('This will disallow all applications that are using the current token. Confirm?')"><i class="fas fa-sync"></i></button></div>
        </div>
    </div>

    <script>
        friendsFeature.all_players_with_servers_details = {{ g.all_players_with_servers_details|tojson }};
        friendsFeature.init();
    </script>
{% endblock %}