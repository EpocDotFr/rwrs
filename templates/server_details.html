{% extends 'layout.html' %}

{% block meta_title %}Servers › {{ server.name }}{% endblock %}

{% block content %}
    <h2><i class="fa fa-server"></i> Servers › {{ server.name }}</h2>

    <p class="txtcenter mbs">
        <a href="{{ server.steam_join_link }}" class="btn"><i class="fa fa-steam"></i> Join</a>

        {% if server.website %}
            <a href="{{ server.website }}" class="btn"><i class="fa fa-external-link"></i> Server's website</a>
        {% endif %}
    </p>

    <div class="grid has-gutter">
        <div class="two-thirds">
            <table class="mbs">
                <tr>
                    <th>IP:Port</th>
                    <td>{{ server.ip_and_port }}</td>
                    <th>Location</th>
                    <td>
                        {% if server.location.country_code %}
                            <i class="flag flag-{{ server.location.country_code }}"></i> {{ server.location.country_name }}
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <th>Current players</th>
                    <td class="{{ 'txtorange' if server.players.free in (1, 2) else 'txtred' if server.players.free == 0 else '' }}">{{ server.players.current }}</td>
                    <th>Max players</th>
                    <td>{{ server.players.max }}</td>
                </tr>
                <tr>
                    <th>Bots</th>
                    <td>{{ server.bots }}</td>
                    <th>Version</th>
                    <td>{{ server.version }}</td>
                </tr>
                <tr>
                    <th>Last updated</th>
                    <td>{{ server.last_updated|humanize_seconds }} ago</td>
                    <th>Message</th>
                    <td>{{ server.comment }}</td>
                </td>
            </table>

            <table class="mbn">
                <tr>
                    <th>Players list</th>
                </tr>
                {% for player in server.players.list %}
                    <tr>
                        <td>
                            <a href="{{ url_for('player_stats', username=player) }}">{{ player }}</a>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
        <div class="one-third">
            <table>
                <tr>
                    <th class="txtcenter">Current map</th>
                </tr>
                <tr>
                    <td class="txtcenter">
                        {% if server.map.name %}
                            {% if server.map.is_official %}
                                <a href="https://runningwithrifles.gamepedia.com/Special:Search/{{ server.map.name }}">
                            {% endif %}
                                {{ server.map.name }}
                            {% if server.map.is_official %}
                                </a>
                            {% endif %}
                        {% else %}
                            {{ server.map.id }}
                        {% endif %}
                    </td>
                </tr>
                {% if server.map.is_official %}
                    <tr>
                        <td class="txtcenter">
                            <img src="{{ url_for('static', filename='images/maps/{map_id}.jpg'.format(map_id=server.map.id)) }}">
                        </td>
                    </tr>
                {% endif %}
            </table>
        </div>
    </div>

    <p class="txtcenter">
        <a href="{{ url_for('home') }}" class="btn"><i class="fa fa-user"></i> Search for a player</a> or
        <a href="{{ url_for('servers_list') }}" class="btn"><i class="fa fa-server"></i> Go back to the public servers list</a>
    </p>
{% endblock %}